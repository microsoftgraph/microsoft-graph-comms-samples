<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Graph Calling SDK </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Graph Calling SDK ">
    <meta name="generator" content="docfx 2.39.2.0">
    
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="graph-calling-sdk">Graph Calling SDK</h1>

<h2 id="introduction">Introduction</h2>
<p>The Graph Calling SDK simplifies the creation of calling and meetings bots that use the Microsoft Graph Calling APIs.  The Graph Calling SDK provides the functionality to manage states of resources in memory and takes care of tasks like call setup and media session establishment. The Graph Calling SDK provides interfaces for bot service-to-service interactions with calls and meetings, including an optional Media Extension SDK that enables a bot developer to host media locally and gain access to low level Audio/Video sockets and media streams.</p>
<h2 id="sdk">SDK</h2>
<p>The Graph Calling SDK is built on top of the Microsoft Graph API and distributed as NuGet packages.  The <a href="articles/index.html">Core Concepts</a> article is designed to better explain all the constructs used by the SDKs.  To dive right in and deploy a Calling Bot refer to the <a href="articles/Samples.md">Graph Calling SDK Samples Overview</a> article for further instruction.</p>
<h2 id="example-scenarios">Example Scenarios</h2>
<p>To illustrate functionality of the Graph Calling SDK, the below examples demonstrate 2 common scenarios: how to make an outbound call to a Microsoft Teams user and how to join an existing Microsoft Teams meeting.</p>
<h4 id="making-an-outbound-call">Making an Outbound Call</h4>
<p>Assuming a bot has been properly registered and deployed, the <a href="articles/index.html">IStatefulClient</a> configured and built.</p>
<p>The bot needs to create the <a class="xref" href="core/Microsoft.Graph.Call.html">Call</a> object with the corresponding parameters and pass the object to the <a class="xref" href="calling/Microsoft.Graph.Calls.CallCollectionExtensions.html#Microsoft_Graph_Calls_CallCollectionExtensions_AddAsync_Microsoft_Graph_Calls_ICallCollection_Call_Microsoft_Graph_Calls_IMediaSession_System_Boolean_CancellationToken_">CallCollectionExtensions.AddAsync</a> method as follows:</p>
<pre><code>var call = new Call
{
    Subject = &quot;**Subject**&quot;,
    Targets = new List&lt;ParticipantInfo&gt;
                {
                    new InvitationParticipantInfo
                    {
                        Identity = new IdentitySet
                        {
                            User = new Identity
                            {
                                Id = &quot;**Target&#39;s AAD ObjectId GUID**&quot;
                            },
                        },
                    }
                }
};

var mediaSession = this.Client.CreateMediaSession(**custom media session settings**);

var statefulCall = await this.Client.Calls().AddAsync(call, mediaSession);
</code></pre><p>SDK will store the state of the call in memory after calling <code>AddAsync</code>. The returned <code>statefulCall</code> above contains the call Id set by the service.</p>
<h4 id="making-an-outbound-call-to-join-an-existing-microsoft-teams-meeting">Making an Outbound Call to Join an Existing Microsoft Teams Meeting</h4>
<p>The above example shows how to create an outbound call to single or multiple participants to create a new conversation. If the bot needs to join an existing conversation, the SDK provides an overload of AddAsync that takes <a class="xref" href="calling/Microsoft.Graph.Calls.JoinMeetingParameters.html">JoinMeetingParameters</a> as input.
The bot needs to create the <a class="xref" href="calling/Microsoft.Graph.Calls.JoinMeetingParameters.html">JoinMeetingParameters</a> object with the corresponding meeting parameters and pass the object to the <a class="xref" href="calling/Microsoft.Graph.Calls.CallCollectionExtensions.html#Microsoft_Graph_Calls_CallCollectionExtensions_AddAsync_Microsoft_Graph_Calls_ICallCollection_Microsoft_Graph_Calls_JoinMeetingParameters_CancellationToken_">CallCollectionExtensions.AddAsync</a> method as follows:</p>
<pre><code>var mediaSession = this.Client.CreateMediaSession(**custom media session settings**);
var joinCallParameters = new JoinMeetingParameters(
new ChatInfo
{
    MessageId = &quot;**Message Id**&quot;,
    ThreadId = &quot;**Thread Id**&quot;,
    ReplyChainMessageId = &quot;**Reply Chain Message Id**&quot;
},
new OrganizerMeetingInfo
{
    Organizer = new IdentitySet
                {
                    User = new Identity
                    {
                        Id = &quot;**Meeting Organizer&#39;s AAD ObjectId GUID**&quot;
                    },
                },    
    TenantId = **OrganizerId Guid**
},
mediaSession);

var statefulCall = await this.Client.Calls().AddAsync(joinCallParameters);
</code></pre><p>SDK will store the state of the call in memory after calling <code>AddAsync</code>. The returned <code>statefulCall</code> above contains the callId set by the service.</p>
<h2 id="state-management">State Management</h2>
<p>Graph Calling SDK can be used to store state of all resources of the call in memory.  This has 2 implications:</p>
<ol>
<li>The instance hosting the call needs to be up throughout the lifetime of the call.</li>
<li>Any subsequent asynchronous notifications triggered by the service need to be directed to the instance hosting the call.</li>
</ol>
<p>Any bot that hosts its own media stack needs to be built using the Graph Calling SDK given that the media stream has a requirement that it needs to persist in memory throughout the lifetime of the call.</p>
<p>More details can be found in the <a href="articles/calling/StateManagement.html">State Management</a> article.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://skype.visualstudio.com/DefaultCollection/SBS/_git/service-shared_platform_core?path=SDK/Documentation/index.md&amp;version=GBdevelop&amp;line=1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
